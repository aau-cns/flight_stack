<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (C) 2022-2023 Martin Scheiber, Christian Brommer,
and others, Control of Networked Systems, University of Klagenfurt, Austria.

All rights reserved.

This software is licensed under the terms of the BSD-2-Clause-License with
no commercial use allowed, the full terms of which are made available
in the LICENSE file. No license in patents is granted.

You can contact the authors at <martin.scheiber@ieee.org>, <christian.brommer@ieee.org>.
-->

<launch>
  <arg name="platform"  default="pi" />

  <arg name="device_id"         default="AMA0"  if="$(eval arg('platform') == 'pi')"/>
  <arg name="device_id"         default="SAC0"  if="$(eval arg('platform') == 'xu4')" />
  <arg name="device_id"         default="THS0"  if="$(eval arg('platform') == 'agx')" />
  <arg name="device_id"         default="USB0"  if="$(eval arg('platform') == 'pc')" />
  <arg name="device_id"         default="udp://:14550@127.0.0.1:14577"
                                if="$(eval arg('platform') == 'sim')" />

  <arg name="conn_baudrate"     default="921600" />

  <!-- default mavros parameters -->
  <arg name="config_file"       default="$(find mavros)/launch/px4_config.yaml" />
  <arg name="pluginlists_file"  default="$(find mavros)/launch/px4_pluginlists.yaml" />
  <arg name="fcu_url"           default="/dev/tty$(arg device_id):$(arg conn_baudrate)" 
                                  unless="$(eval arg('platform') == 'sim')" />
  <arg name="fcu_url"           default="$(arg device_id)" 
                                  if="$(eval arg('platform') == 'sim')" />
  <arg name="gcs_url"           default="" />
  <arg name="tgt_system"        default="1" />
  <arg name="tgt_component"     default="1" />
  <arg name="log_output"        default="screen" />
  <arg name="fcu_protocol"      default="v2.0" />
  <arg name="respawn_mavros"    default="false" />

  <include file="$(find mavros)/launch/node.launch">
    <arg name="pluginlists_yaml"  value="$(arg pluginlists_file)" />
    <arg name="config_yaml"       value="$(arg config_file)" />

    <arg name="fcu_url"           value="$(arg fcu_url)" />
    <arg name="gcs_url"           value="$(arg gcs_url)" />
    <arg name="tgt_system"        value="$(arg tgt_system)" />
    <arg name="tgt_component"     value="$(arg tgt_component)" />
    <arg name="log_output"        value="$(arg log_output)" />
    <arg name="fcu_protocol"      value="$(arg fcu_protocol)" />
    <arg name="respawn_mavros"    value="$(arg respawn_mavros)" />
  </include>
</launch>
